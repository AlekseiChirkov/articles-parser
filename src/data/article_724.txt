Название: Взаимное автоматическое распечатывание двух Vault кластеров в
Kubernetes

Автор: stas_tibekin

Дата: 2021-09-20, 06:46

Теги: Блог компании Nixys, Системное администрирование *, IT-инфраструктура
*, IT-стандарты *, DevOps *

Контент: Введение Когда я устанавливаю Vault в Kubernetes, я держу в голове,
что очень важно иметь возможность сделать автоматическое
распечатывание(Auto-Unseal), чтобы кластер Vault был по настоящему
высокодоступным. В моей предыдущей статье "Highly available Vault
cluster in Kubernetes" (ссылка), несмотря на то, что я изо всех сил
пытался сделать кластер Vault максимально доступным, без
автоматического распечатывания кластер Vault мог бы выдержать
частичный отказ подов, но не пережил бы перезагрузку всего кластера. В
этой статье хорошо объяснено, почему это произошло. Для меня проблема
заключается в том, что я не пользуюсь "службой AWS KMS", которую можно
было бы использовать, или подобной службы безопасности от "облачного"
провайдера, потому что я управляю Kubernetes на self-hosted "облаке"
(в этой статье объясняется моя настройка). В Vault версии 1.1
добавлена поддержка "Transit Auto Unseal", которая заключается в
использовании второго Vault кластера B для автоматического
распечатывания (Auto-Unseal) кластера А. Итак, вот идея: развернуть 2
кластера Vault A и B и настроить их так, чтобы они делали
автоматическое распечатывание друг для друга.