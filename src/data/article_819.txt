Название: Работа с СОМ-портом на Си в linux

Автор: dlinyj

Дата: 2021-09-17, 12:00

Теги: Блог компании RUVDS.com, Программирование *, Системное
программирование *, Разработка под Linux *, Производство и разработка
электроники *

Контент: Телетайп, на который БЭВМ могли выводить и получать данные. Фото взято
здесь.   Каждый, кто постоянно занимается электроникой и программирует
встраиваемые устройства, неизбежно сталкивается с необходимостью
работы с СОМ-портом под линуксом. Недаром, моя статья "UART и с чем
его едят" спустя 11 лет после выпуска набирает просмотры и
комментарии.    Для разработчиков чаще всего появляется задача сопрячь
какой-то датчик, либо удалённое устройство с одноплатником. Да что
греха таить, сейчас в 2021 году UART, наверное, самый распространённый
интерфейс для обмена данными, несмотря на всю его архаичность. Далеко
за примером ходить не надо, внутри смартфона, лежащего у вас в
кармане, будет с десяток UART интерфейсов, самый известный из которых
— это подключение SIM-карты.   Поэтому умение работать с СОМ-портами в
linux особенно важно. И вот, казалось бы, UART, древнейший интерфейс,
всё должно быть известно и понятно, и даже опытные программисты ломают
зубы, работая с ним в линуксе. Особенный цирк с конями начинается при
работе с передачей сырых данных по RS-485. Не знаю ни одного
программиста, который бы не хватил горя при разработке ПО для таких
решений. Самое забавное, что с более новомодным i2c работать в линуксе
куда проще и понятнее, чем с ортодоксальным UART. Чтобы не было
путаницы дальше, всё семейство UART (RS-232, RS-485, UART 5V, UART 3,3
и т.д.) по тексту я буду называть COM-порт или UART. Мы говорим в
статье не о физическом интерфейсе, а о программной стороне вопроса.
В этой статье я хочу показать, как писать свои программы, работающие с
UART в ОС Linux. И неважно на каком языке вы пишете программу для
работы с UART (python, c, c++, bash, php, perl и т.д.), принцип работы
и грабли будут одни и те же, так как всё равно всё упирается в
системные вызовы к ядру. А непонимание того, что там происходит и
приводит к различным трудноуловимым багам.